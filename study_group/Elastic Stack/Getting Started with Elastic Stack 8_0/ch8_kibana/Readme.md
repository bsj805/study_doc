# Kibana 

Elastic SearchëŠ” ë°ì´í„° ì €ì¥, ì¿¼ë¦¬, ì§‘ê³„. 

ë¬¸ì œì 
- ìƒí˜¸ì‘ìš©ë°©ë²•ì€ REST API.
- ì‹œê°í™” ì•ˆë¨ 

kibanaëŠ” ES ë¡œë¶€í„° ë°ì´í„° ì†ŒìŠ¤ë¥¼ ê°€ì ¸ì™€ì„œ statelessí•¨. 

í‚¤ë°”ë‚˜ ì¸ìŠ¤í„´ìŠ¤ëŠ” í´ëŸ¬ìŠ¤í„°ëœ ì»´í¬ë„ŒíŠ¸ê°€ ì•„ë‹ˆë¼ ì‘ì—…ì´ë‚˜ ì›Œí¬ë¡œë“œë¥¼ ê³µìœ í•˜ê¸° ìœ„í•´ ë‹¤ë¥¸ í‚¤ë°”ë‚˜ ì¸ìŠ¤í„´ìŠ¤ë‘ ìƒí˜¸ì‘ìš© í•˜ì§€ ì•ŠìŒ. - statelessë‹ˆê¹Œ ì•„ë¬´ë˜ë„..

ì—¬ëŸ¬ í‚¤ë°”ë‚˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ê°™ì€ ESë¥¼ ê°€ë¦¬í‚¤ê³  ìˆì„ìˆ˜ëŠ” ìˆì§€. 


# ì‚¬ìš©ì„± ì¢‹ì€ ë©”ë‰´ë“¤

- Discover : ë¡œê·¸ ì°¾ê¸°, í•„í„° 
- Dashboard : ë¡œê·¸ ì¶”ì„¸ í™•ì¸
- Canvas : ì‹¤ì‹œê°„ ë°ì´í„°ë¡œ ê·¸ë˜í”½ í”„ë ˆì  í…Œì´ì…˜. DashboardëŠ” ë¶„ì„ ë‹¨ê³„ì •ë„, ìº”ë°”ìŠ¤ëŠ” ê²½ì˜ì§„ì´ë‚˜ ì‚¬ìš©ìì—ê²Œ í†µì°°ë ¥ ì œê³µìš©ë„
- Maps: ì§€ë¦¬ê³µê°„ ì‹œê°í™”, ì‘ì—… 



# ë°ì´í„° ë·° 

ë°ì´í„° ë·°ëŠ” ì¿¼ë¦¬ë‚˜, ëŒ€ì‹œë³´ë“œì— ë°ì´í„° ì†ŒìŠ¤ê°€ ë˜ëŠ” ì—˜ë¼ìŠ¤í‹± ì„œì¹˜ì˜ ê¸°ë³¸ ì¸ë±ìŠ¤ì—ì„œ ì–´ë–¤ ì¸ë±ìŠ¤ë¥¼ ê°€ì ¸ì™€ì„œ ë³¼ ì§€ ê²°ì •í•œë‹¤.

í•´ë‹¹ ì¸ë±ìŠ¤ ê·¸ë£¹ì˜ ë°ì´í„° í•„ë“œ ì´ë¦„ ë³„ ìŠ¤í‚¤ë§ˆë¥¼ í¬í•¨í•´ ë©”íƒ€ë°ì´í„° ì¼ë¶€ë¥¼ ìºì‹±í•œë‹¤. 
    - ì´ ìºì‹œë¥¼ ì—…ë°ì´íŠ¸í•˜ì§€ ì•Šìœ¼ë©´, ë¡œê¹… í•„ë“œë¥¼ ì¶”ê°€í–ˆì„ ë•Œ ì²˜ìŒì—ëŠ” ê·¸ í•„ë“œë¡œ ê²€ìƒ‰í•  ìˆ˜ê°€ ì—†ë‹¤. ìŠ¤í‚¤ë§ˆëŠ” ë°ì´í„° ë·° ë³„ë¡œ ìºì‹œë˜ì–´ ìˆê¸° ë–„ë¬¸ì—. 
`kibana ë°ì´í„°ë·°` == `kibana index pattern` ì˜›ë‚ ì—ëŠ” index patternì´ë¼ê³  í–ˆë‹¤. 

## ë§Œì•½ ëŸ°íƒ€ì„ í•„ë“œë¥¼ ë§Œë“¤ê³  ì‹¶ìœ¼ë©´? 

ëŸ°íƒ€ì„ í•„ë“œ :ì›ë˜ ë°ì´í„°ì—ëŠ” ì •ì˜ë˜ì–´ìˆì§€ ì•Šì§€ë§Œ, ì¶”ê°€ì ìœ¼ë¡œ ë¬¶ì–´ì„œ ë³´ê³  ì‹¶ì€ ëŒ€ìƒ.

ì˜ˆë¥¼ë“¤ë©´, ì¶œë°œ ê³µí•­ì´ë‘ ë„ì°© ê³µí•­ì„ í•˜ë‚˜ì˜ ê°’ìœ¼ë¡œ ë‚˜íƒ€ë‚´ëŠ” Routeë¼ëŠ” í•„ë“œê°€ ìœ ìš©í•  ìˆ˜ë„ ìˆë‹¤. 

```
emit(doc['StartAirport'].value + ">" + doc['EndAirport'].value);
```

kibana data viewì—ì„œ ì„¸íŒ…ì„ í•  ìˆ˜ê°€ ìˆë‹¤. 


![img.png](img.png)

í›¨ì”¬ ê¹”ë”í•˜êµ¬ë§Œ 


## ì»¤ìŠ¤í…€ í•„ë“œ 

```
if (doc['message'].size() == 0) return null;
def m = /@REQUEST@:\s+(\w)+\s+([^\s,]+)/.matcher(doc['message'].value);
if (m.find()) {
  return m.group(1) + m.group(2);
}
return null;

```

ë‚´ê°€ ë­”ê°€ 'message'í•„ë“œì— @REQUEST@: POST /abc/create_new blabla  ì´ë ‡ê²Œ ë‚¨ê¸°ê³ ìˆëŠ” ê²Œ ìˆì–´ì„œ ì´ë ‡ê²Œ í•´ë³´ë ¤ë‹ˆê¹Œ, 'message' í•„ë“œëŠ” 'text' í•„ë“œë¼ì„œ ì•ˆëœë‹¤ê³  í•œë‹¤. 

ğŸ”¹ message

ë¶„ì„ëœ í…ìŠ¤íŠ¸ (analyzed)

ê²€ìƒ‰ì—”ì§„ì´ ë‹¨ì–´ ë‹¨ìœ„ë¡œ ë¶„ë¦¬í•´ì„œ ìƒ‰ì¸

doc['message']ë¡œ ì§‘ê³„ë‚˜ sortí•˜ë ¤ê³  í•˜ë©´ âŒ ì˜¤ë¥˜ë‚¨

(â€œtext field canâ€™t be used for aggregations or scriptingâ€)

ğŸ”¹ message.keyword

ë¹„ë¶„ì„ ë¬¸ìì—´ (not analyzed)

ì›ë³¸ ê·¸ëŒ€ë¡œ ì €ì¥

ì •ë ¬, ì§‘ê³„, scripted field ì²˜ë¦¬ì— âœ… ì•ˆì „í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥



ì¦‰, ì´ë¯¸ messageëŠ” ë‹¨ìœ„ ë‹¨ìœ„ë¡œ ìª¼ê°œì ¸ ìˆì–´ì„œ, ë‚´ ë°©ì‹ì²˜ëŸ¼ ì ‘ê·¼ì´ ë¶ˆê°€ëŠ¥í•œ í˜•íƒœì¸ ê²ƒ.  


## Elastic Searchì—ì„œì˜ Break down by 

![img_1.png](img_1.png)

ì´ëŸ°ì‹ìœ¼ë¡œ split seriesë¡œ êµ¬í˜„í•˜ë©´ ëœë‹¤.

count of recordë¥¼ logger.level ì— ë”°ë¼ì„œ ë³´ê³ ì‹¶ë‹¤ë©´ ì´ì²˜ëŸ¼ í•  ìˆ˜ ìˆê² ë‹¤. 



